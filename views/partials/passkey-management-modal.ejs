<!-- Passkey Management Modal -->
<div class="modal fade" id="passkeyManagementModal" tabindex="-1" aria-labelledby="passkeyManagementModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content" style="background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-radius: 20px; border: 1px solid rgba(255, 255, 255, 0.2);">
      <div class="modal-header" style="background: linear-gradient(45deg, #667eea, #764ba2); color: white; border-radius: 20px 20px 0 0;">
        <h5 class="modal-title" id="passkeyManagementModalLabel">
          <i class="fas fa-fingerprint me-2"></i>Manage Passkeys
        </h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      
      <div class="modal-body p-4">
        <!-- Passkey Support Check -->
        <div id="passkeyNotSupported" class="alert alert-warning d-none">
          <i class="fas fa-exclamation-triangle me-2"></i>
          Passkeys are not supported on this device or browser. Please use a compatible device with Face ID, Touch ID, Windows Hello, or a security key.
        </div>

        <!-- Add New Passkey Section -->
        <div id="addPasskeySection" class="card shadow-sm mb-4" style="border-radius: 15px; border: none;">
          <div class="card-body" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 15px;">
            <div class="d-flex align-items-center mb-3">
              <div class="bg-primary rounded-circle p-3 me-3" style="width: 50px; height: 50px; display: flex; align-items: center; justify-content: center;">
                <i class="fas fa-plus text-white"></i>
              </div>
              <div>
                <h6 class="mb-1 fw-bold">Add New Passkey</h6>
                <small class="text-muted">Set up a new passkey for this device</small>
              </div>
            </div>
            
            <div class="mb-3">
              <label for="newPasskeyName" class="form-label">Device Name (Optional)</label>
              <input type="text" class="form-control" id="newPasskeyName" placeholder="e.g., My iPhone, Work Laptop">
              <div class="form-text">Give this passkey a recognizable name</div>
            </div>
            
            <button type="button" class="btn btn-primary w-100" id="addPasskeyBtn">
              <i class="fas fa-fingerprint me-2"></i>Create Passkey
            </button>
          </div>
        </div>

        <!-- Existing Passkeys Section -->
        <div class="card shadow-sm" style="border-radius: 15px; border: none;">
          <div class="card-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 15px 15px 0 0;">
            <h6 class="mb-0">
              <i class="fas fa-key me-2"></i>Your Passkeys (<span id="passkeyCount">0</span>)
            </h6>
          </div>
          
          <div class="card-body p-0">
            <div id="passkeyList" class="list-group list-group-flush">
              <!-- Passkeys will be populated here -->
            </div>
            
            <div id="noPasskeysMessage" class="text-center py-4 text-muted">
              <i class="fas fa-key fa-2x mb-3 opacity-50"></i>
              <p class="mb-0">No passkeys configured yet</p>
              <small>Add your first passkey above for enhanced security</small>
            </div>
          </div>
        </div>

        <!-- Recovery Information -->
        <div class="alert alert-info mt-4" style="border-radius: 15px; border: none; background: rgba(13, 202, 240, 0.1);">
          <div class="d-flex align-items-start">
            <i class="fas fa-info-circle text-info me-3 mt-1"></i>
            <div>
              <h6 class="text-info mb-2">About Passkeys</h6>
              <ul class="small mb-0 text-muted">
                <li>Passkeys are more secure than passwords and impossible to phish</li>
                <li>They work with Face ID, Touch ID, Windows Hello, or security keys</li>
                <li>If you lose access to a passkey, you can still sign in with your password or other passkeys</li>
                <li>You can add multiple passkeys for different devices</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      
      <div class="modal-footer" style="border-top: 1px solid rgba(0,0,0,0.1);">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" id="refreshPasskeysBtn">
          <i class="fas fa-sync-alt me-2"></i>Refresh
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Passkey Rename Modal -->
<div class="modal fade" id="renamePasskeyModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" style="border-radius: 15px;">
      <div class="modal-header">
        <h5 class="modal-title">Rename Passkey</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label for="renamePasskeyInput" class="form-label">Device Name</label>
          <input type="text" class="form-control" id="renamePasskeyInput" maxlength="100">
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" id="savePasskeyNameBtn">Save</button>
      </div>
    </div>
  </div>
</div>

<style>
/* Passkey Management Styles */
.passkey-item {
  transition: all 0.3s ease;
  border-radius: 12px !important;
  margin: 8px;
  background: rgba(255, 255, 255, 0.8);
}

.passkey-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  background: rgba(255, 255, 255, 0.95);
}

.passkey-device-icon {
  width: 45px;
  height: 45px;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  color: white;
  background: linear-gradient(45deg, #667eea, #764ba2);
}

.passkey-device-icon.phone { background: linear-gradient(45deg, #ff6b6b, #ee5a24); }
.passkey-device-icon.laptop { background: linear-gradient(45deg, #4834d4, #6c5ce7); }
.passkey-device-icon.desktop { background: linear-gradient(45deg, #26de81, #20bf6b); }
.passkey-device-icon.tablet { background: linear-gradient(45deg, #fd79a8, #fdcb6e); }
.passkey-device-icon.security_key { background: linear-gradient(45deg, #a29bfe, #6c5ce7); }

.passkey-actions .btn {
  border-radius: 8px;
  border: none;
  font-size: 0.8rem;
  padding: 0.25rem 0.5rem;
  margin: 0 2px;
}

.device-status-badge {
  font-size: 0.7rem;
  padding: 0.25rem 0.5rem;
  border-radius: 10px;
}

.last-used-text {
  font-size: 0.75rem;
  color: #6c757d;
}
</style>

<!-- JavaScript moved to external file /js/passkey-client.js to comply with CSP --> 